# –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫—Ä–∏–ø—Ç—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `server/` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```env
# Server configuration
PORT=8000

# JWT Secret Key
JWT_SECRET=your_secret_key_here

# User ID for scripts (optional)
# –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, —Å–∫—Ä–∏–ø—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º–æ–π
# –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω, —Å–∫—Ä–∏–ø—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
USER_ID=1
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è USER_ID:
1. –ò–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã)
2. –ò–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `USER_ID` (–∏–∑ `.env` —Ñ–∞–π–ª–∞)
3. –ü—É–±–ª–∏—á–Ω–∞—è —Å—Ö–µ–º–∞ (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ)

---

## populate-test-workers.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã `workers` —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç 10 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏ —Ñ–∞–º–∏–ª–∏—è–º–∏. –ü–æ–ª–µ `position` –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ "worker", –ª–∏–±–æ "itr" (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º).

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm run populate-workers
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/populate-test-workers.js
```

#### 3. –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–ø–æ–ª–Ω–∏—Ç —Å—Ö–µ–º—É user_X)

```bash
node scripts/populate-test-workers.js 1
```

–ì–¥–µ `1` - —ç—Ç–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∫—Ä–∏–ø—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç —Ç–∞–±–ª–∏—Ü—É `workers` –≤ —Å—Ö–µ–º–µ `user_1`.

### –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `USER_ID` –∏–∑ `.env` —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω –∞—Ä–≥—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è userId (–Ω–∏ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö, –Ω–∏ –≤ `.env`) —Å–∫—Ä–∏–ø—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø—É–±–ª–∏—á–Ω—É—é —Å—Ö–µ–º—É (`public`)
- –° —É–∫–∞–∑–∞–Ω–∏–µ–º userId (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`) —Å–∫—Ä–∏–ø—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ö–µ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`user_1`)
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, –µ—Å–ª–∏ –æ–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=1
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
npm run populate-workers
```

#### 2. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º—ã (–±–µ–∑ .env –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤)

```bash
npm run populate-workers
```

#### 3. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç .env)

```bash
node scripts/populate-test-workers.js 1
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
–ù–∞—á–∏–Ω–∞—é –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã workers —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏...
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: public

1. –î–æ–±–∞–≤–ª–µ–Ω: –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ò–≤–∞–Ω–æ–≤ (worker)
2. –î–æ–±–∞–≤–ª–µ–Ω: –î–º–∏—Ç—Ä–∏–π –ü–µ—Ç—Ä–æ–≤ (itr)
3. –î–æ–±–∞–≤–ª–µ–Ω: –ú–∞–∫—Å–∏–º –°–º–∏—Ä–Ω–æ–≤ (worker)
...

‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ 10 –∏–∑ 10 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É workers

üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º:
   worker: 6
   itr: 4

üéâ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

---

## clear-workers.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `workers`.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É `workers` –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ö–µ–º–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∏–ª–∏ –ø—É–±–ª–∏—á–Ω–æ–π).

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script

```bash
npm run clear-workers
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/clear-workers.js
```

#### 3. –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—á–∏—Å—Ç–∏—Ç —Å—Ö–µ–º—É user_X)

```bash
node scripts/clear-workers.js 1
```

–ì–¥–µ `1` - —ç—Ç–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∏—Ç —Ç–∞–±–ª–∏—Ü—É `workers` –≤ —Å—Ö–µ–º–µ `user_1`.

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `USER_ID` –∏–∑ `.env` —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω –∞—Ä–≥—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è userId (–Ω–∏ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö, –Ω–∏ –≤ `.env`) —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª–∏—Ç –í–°–ï –∑–∞–ø–∏—Å–∏ –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º—ã (`public`)
- –° —É–∫–∞–∑–∞–Ω–∏–µ–º userId (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`) —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª–∏—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ —Å—Ö–µ–º—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`user_1`)
- **–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!**
- –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –û—á–∏—Å—Ç–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=1
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
npm run clear-workers
```

#### 2. –û—á–∏—Å—Ç–∫–∞ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º—ã (–±–µ–∑ .env –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤)

```bash
npm run clear-workers
```

#### 3. –û—á–∏—Å—Ç–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç .env)

```bash
node scripts/clear-workers.js 1
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –í–°–ï –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã workers –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1!
–°—Ö–µ–º–∞: user_1
–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.

–ù–∞—á–∏–Ω–∞—é –æ—á–∏—Å—Ç–∫—É —Ç–∞–±–ª–∏—Ü—ã workers...
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: user_1

–ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: 10

‚úÖ –£—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ 10 –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã workers –≤ —Å—Ö–µ–º–µ user_1
üìä –û—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π: 0

üéâ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

---

## clear-parent-calculations.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `parent_calculation` –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É `parent_calculation` –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ö–µ–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ `parent_calculation` –∑–∞–ø–∏—Å–∏ –∫–∞—Å–∫–∞–¥–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ `calculation` –∑–∞–ø–∏—Å–∏ –∏ –≤—Å–µ –∏—Ö –¥–æ—á–µ—Ä–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ (specification_data, workers_data, itr_data, workers_tax_data, itr_tax_data) –±–ª–∞–≥–æ–¥–∞—Ä—è FOREIGN KEY —Å ON DELETE CASCADE.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm run clear-parent-calculations
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/clear-parent-calculations.js 1
```

–ì–¥–µ `1` - —ç—Ç–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∏—Ç —Ç–∞–±–ª–∏—Ü—É `parent_calculation` –≤ —Å—Ö–µ–º–µ `user_1`.

#### 3. –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=1
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
npm run clear-parent-calculations
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç** —É–∫–∞–∑–∞–Ω–∏—è `USER_ID` (–≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö –∏–ª–∏ –≤ `.env` —Ñ–∞–π–ª–µ)
- –° —É–∫–∞–∑–∞–Ω–∏–µ–º userId (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`) —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª–∏—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ —Å—Ö–µ–º—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`user_1`)
- **–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!**
- –í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã (calculations) –∏ –∏—Ö –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∫–∞—Å–∫–∞–¥–Ω–æ
- –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (parent_calculation –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö calculations)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –û—á–∏—Å—Ç–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1 (—á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç)
```bash
node scripts/clear-parent-calculations.js 1
```

#### 2. –û—á–∏—Å—Ç–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env (—á–µ—Ä–µ–∑ npm)
```bash
# –í .env: USER_ID=1
npm run clear-parent-calculations
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –í–°–ï –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã parent_calculation –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1!
–°—Ö–µ–º–∞: user_1
–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.

–ù–∞—á–∏–Ω–∞—é –æ—á–∏—Å—Ç–∫—É —Ç–∞–±–ª–∏—Ü—ã parent_calculation...
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: user_1

–ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π parent_calculation: 5
–ù–∞–π–¥–µ–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π calculation: 15
(–í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ calculations –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∫–∞—Å–∫–∞–¥–Ω–æ)

‚úÖ –£—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ 5 –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã parent_calculation
‚úÖ –£–¥–∞–ª–µ–Ω–æ 15 —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ (calculations)
üìä –û—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π –≤ parent_calculation: 0

üéâ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

---

## clone-calculation.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π `calculation` —Å–æ –≤—Å–µ–º–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –∫–æ–ø–∏—Ä—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `calculation` –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–π –¥–∞–Ω–Ω—ã–µ (specification_data, workers_data, itr_data, workers_tax_data, itr_tax_data, calculation_media_files). –¢–∞–∫–∂–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é `parent_calculation` –∑–∞–ø–∏—Å—å, –µ—Å–ª–∏ `calculation_type = 'plan'`.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script (—Å USER_ID –≤ .env)

```bash
npm run clone-calculation
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/clone-calculation.js [sourceCalcId] [userId]
```

–ì–¥–µ:
- `sourceCalcId` - ID –∏—Å—Ö–æ–¥–Ω–æ–π calculation –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)
- `userId` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, –±–µ—Ä–µ—Ç—Å—è –∏–∑ .env)

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç** —É–∫–∞–∑–∞–Ω–∏—è `USER_ID` (–≤ `.env` –∏–ª–∏ —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç)
- –ö–ª–æ–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π calculation
- –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é `parent_calculation`, –µ—Å–ª–∏ `calculation_type = 'plan'`
- –î–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `parent_calculation_id`

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ calculation ID=1 –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=3
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
node scripts/clone-calculation.js 1
```

#### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç .env)

```bash
node scripts/clone-calculation.js 1 3
```

#### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–π calculation

```bash
node scripts/clone-calculation.js 2 1
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
–ù–∞—á–∏–Ω–∞—é –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ calculation ID=1 –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 3
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: user_3

‚úì –ù–∞–π–¥–µ–Ω–∞ calculation: "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç"
  –¢–∏–ø: plan
  Parent ID: 1
‚úì –ó–∞–≥—Ä—É–∂–µ–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
  - specification_data: 5 –∑–∞–ø–∏—Å–µ–π
  - workers_data: 10 –∑–∞–ø–∏—Å–µ–π
  - itr_data: 3 –∑–∞–ø–∏—Å–µ–π
  - workers_tax_data: 12 –∑–∞–ø–∏—Å–µ–π
  - itr_tax_data: 8 –∑–∞–ø–∏—Å–µ–π
  - calculation_media_files: 3 —Ñ–∞–π–ª–∞

‚úì –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è parent_calculation ID=2: "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç (–∫–æ–ø–∏—è 2024-01-15)"
‚úì –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è calculation ID=2: "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç (–∫–æ–ø–∏—è)"
  ‚úì –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ specification_data_table: 5 –∑–∞–ø–∏—Å–µ–π
  ‚úì –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ workers_data_table: 10 –∑–∞–ø–∏—Å–µ–π
  ‚úì –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ itr_data_table: 3 –∑–∞–ø–∏—Å–µ–π
  ‚úì –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ workers_tax_data: 12 –∑–∞–ø–∏—Å–µ–π
  ‚úì –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ itr_tax_data: 8 –∑–∞–ø–∏—Å–µ–π
  ‚úì –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã: 3 —Ñ–∞–π–ª–∞

‚úÖ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!
üìä –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å:
   - calculation ID: 2
   - parent_calculation ID: 2
   - title: "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç (–∫–æ–ø–∏—è)"

üéâ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

---

## backup-calculations.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü `parent_calculation` –∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –±—ç–∫–∞–ø –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ä–∞—Å—á–µ—Ç–∞–º–∏:
- `parent_calculation` - —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã
- `calculation` - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã
- `specification_data` –∏ `specification_data_table` - –¥–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
- `workers_data` –∏ `workers_data_table` - –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–∞–±–æ—á–∏–º
- `itr_data` –∏ `itr_data_table` - –¥–∞–Ω–Ω—ã–µ –ò–¢–†
- `workers_tax_data` - –Ω–∞–ª–æ–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—á–∏—Ö
- `itr_tax_data` - –Ω–∞–ª–æ–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ò–¢–†
- `calculation_media_files` - –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã (PDF, JPG, PNG), –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ –∫ —Ä–∞—Å—á–µ—Ç–∞–º

–ë—ç–∫–∞–ø —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `server/backups/` —Å –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm run backup-calculations
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/backup-calculations.js [userId]
```

–ì–¥–µ `userId` - —ç—Ç–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç –±—ç–∫–∞–ø –¥–ª—è —Å—Ö–µ–º—ã `user_{userId}`.

#### 3. –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=1
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
npm run backup-calculations
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç** —É–∫–∞–∑–∞–Ω–∏—è `USER_ID` (–≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö –∏–ª–∏ –≤ `.env` —Ñ–∞–π–ª–µ)
- –ë—ç–∫–∞–ø —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `server/backups/`
- –ò–º—è —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è: `backup_user_{userId}_{timestamp}.json`
- –ë—ç–∫–∞–ø –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1 (—á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç)
```bash
node scripts/backup-calculations.js 1
```

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env (—á–µ—Ä–µ–∑ npm)
```bash
# –í .env: USER_ID=1
npm run backup-calculations
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
–ù–∞—á–∏–Ω–∞—é —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1...
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: user_1

‚úì –ù–∞–π–¥–µ–Ω–æ parent_calculation –∑–∞–ø–∏—Å–µ–π: 5

üì¶ –û–±—Ä–∞–±–æ—Ç–∫–∞ parent_calculation ID=1: "–ü—Ä–æ–µ–∫—Ç –ê"
  ‚úì –ù–∞–π–¥–µ–Ω–æ calculations: 3
üì¶ –û–±—Ä–∞–±–æ—Ç–∫–∞ parent_calculation ID=2: "–ü—Ä–æ–µ–∫—Ç –ë"
  ‚úì –ù–∞–π–¥–µ–Ω–æ calculations: 2
...

‚úÖ –ë—ç–∫–∞–ø —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!
üìÅ –§–∞–π–ª: /path/to/server/backups/backup_user_1_2024-01-15_14-30-45.json

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ç–∫–∞–ø–∞:
   - parent_calculations: 5
   - calculations: 15
   - specification_data: 12
   - workers_data: 10
   - itr_data: 8
   - workers_tax_data: 45 –∑–∞–ø–∏—Å–µ–π
   - itr_tax_data: 32 –∑–∞–ø–∏—Å–µ–π
   - calculation_media_files: 8 —Ñ–∞–π–ª–æ–≤

üéâ –ë—ç–∫–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω –≤: /path/to/server/backups/backup_user_1_2024-01-15_14-30-45.json
```

---

## restore-calculations.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—ç–∫–∞–ø–∞.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ –±—ç–∫–∞–ø–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–æ–º `backup-calculations.js`. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –Ω–∏–º–∏.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script

```bash
npm run restore-calculations <backupFilePath> [userId] [--clear]
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/restore-calculations.js <backupFilePath> [userId] [--clear]
```

–ì–¥–µ:
- `backupFilePath` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –±—ç–∫–∞–ø–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- `userId` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, –±–µ—Ä–µ—Ç—Å—è –∏–∑ –±—ç–∫–∞–ø–∞ –∏–ª–∏ .env)
- `--clear` - —Ñ–ª–∞–≥ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç** —É–∫–∞–∑–∞–Ω–∏—è –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É –±—ç–∫–∞–ø–∞
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Ñ–ª–∞–≥ `--clear`, –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- **–î–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–ª–∞–≥–æ–º `--clear` –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!**
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç userId –∏–∑ –±—ç–∫–∞–ø–∞, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –ù–æ–≤—ã–µ ID –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (—Å—Ç–∞—Ä—ã–µ ID –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ (–±–µ–∑ –æ—á–∏—Å—Ç–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö)
```bash
node scripts/restore-calculations.js backups/backup_user_1_2024-01-15_14-30-45.json 1
```

#### 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –æ—á–∏—Å—Ç–∫–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
node scripts/restore-calculations.js backups/backup_user_1_2024-01-15_14-30-45.json 1 --clear
```

#### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env
```bash
# –í .env: USER_ID=1
node scripts/restore-calculations.js backups/backup_user_1_2024-01-15_14-30-45.json
```

#### 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º –ø—É—Ç–µ–º
```bash
node scripts/restore-calculations.js backups/backup_user_1_2024-01-15_14-30-45.json
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º!
–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.

–ù–∞—á–∏–Ω–∞—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞...
–§–∞–π–ª –±—ç–∫–∞–ø–∞: /path/to/server/backups/backup_user_1_2024-01-15_14-30-45.json
–î–∞—Ç–∞ –±—ç–∫–∞–ø–∞: 2024-01-15T14:30:45.123Z
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: user_1

‚ö†Ô∏è  –û—á–∏—Å—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö...
‚úì –£–¥–∞–ª–µ–Ω–æ 3 —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π parent_calculation

üì¶ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ parent_calculation: "–ü—Ä–æ–µ–∫—Ç –ê"
  ‚úì –°–æ–∑–¥–∞–Ω–∞ parent_calculation ID=1
üì¶ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ parent_calculation: "–ü—Ä–æ–µ–∫—Ç –ë"
  ‚úì –°–æ–∑–¥–∞–Ω–∞ parent_calculation ID=2
...

‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:
   - parent_calculations: 5
   - calculations: 15
   - specification_data: 12
   - workers_data: 10
   - itr_data: 8
   - workers_tax_data: 45 –∑–∞–ø–∏—Å–µ–π
   - itr_tax_data: 32 –∑–∞–ø–∏—Å–µ–π
   - calculation_media_files: 8 —Ñ–∞–π–ª–æ–≤

üéâ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

---

## copy-database.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SQL-–¥–∞–º–ø–∞ —Å—Ö–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é `pg_dump`.

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç SQL-–¥–∞–º–ø —Å—Ö–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —É—Ç–∏–ª–∏—Ç—É PostgreSQL `pg_dump`. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `backup-calculations.js`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç JSON-–±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö, —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç SQL-–¥–∞–º–ø –≤—Å–µ–π —Å—Ö–µ–º—ã –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü, –∏–Ω–¥–µ–∫—Å—ã, constraints –∏ –¥–∞–Ω–Ω—ã–µ.

SQL-–¥–∞–º–ø —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `server/dumps/` —Å –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm run copy-database
```

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/copy-database.js [userId]
```

–ì–¥–µ `userId` - —ç—Ç–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç SQL-–¥–∞–º–ø –¥–ª—è —Å—Ö–µ–º—ã `user_{userId}`.

#### 3. –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=1
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
npm run copy-database
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç** —É–∫–∞–∑–∞–Ω–∏—è `USER_ID` (–≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö –∏–ª–∏ –≤ `.env` —Ñ–∞–π–ª–µ)
- –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ `pg_dump` (–æ–±—ã—á–Ω–æ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å PostgreSQL)
- SQL-–¥–∞–º–ø —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `server/dumps/`
- –ò–º—è —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è: `dump_user_{userId}_{timestamp}.sql`
- SQL-–¥–∞–º–ø –≤–∫–ª—é—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ö–µ–º—ã, —Ç–∞–±–ª–∏—Ü, –∏–Ω–¥–µ–∫—Å–æ–≤, constraints –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
- –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `psql` (—Å–º. —Ä–∞–∑–¥–µ–ª "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ SQL-–¥–∞–º–ø–∞")

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ `pg_dump`:

- **macOS**: `brew install postgresql`
- **Ubuntu/Debian**: `sudo apt-get install postgresql-client`
- **Windows**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ (—É—Ç–∏–ª–∏—Ç–∞ –≤—Ö–æ–¥–∏—Ç –≤ –∫–æ–º–ø–ª–µ–∫—Ç)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ SQL-–¥–∞–º–ø–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1 (—á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç)
```bash
node scripts/copy-database.js 1
```

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ SQL-–¥–∞–º–ø–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env (—á–µ—Ä–µ–∑ npm)
```bash
# –í .env: USER_ID=1
npm run copy-database
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üì¶ –ù–∞—á–∏–Ω–∞—é —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ø–∏–∏ –ë–î –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1...
üìã –°—Ö–µ–º–∞: user_1
üóÑÔ∏è  –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: calculations

‚úì –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –¥–∞–º–ø–æ–≤: /path/to/server/dumps
üîß –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞: pg_dump ...
   –°—Ö–µ–º–∞: user_1
   –§–∞–π–ª: /path/to/server/dumps/dump_user_1_2024-01-15_14-30-45.sql

‚úÖ –ö–æ–ø–∏—è –ë–î —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!
üìÅ –§–∞–π–ª: /path/to/server/dumps/dump_user_1_2024-01-15_14-30-45.sql
üìä –†–∞–∑–º–µ—Ä: 901.20 KB

üí° –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
   psql -U postgres -h localhost -p 5432 -d calculations -f "/path/to/server/dumps/dump_user_1_2024-01-15_14-30-45.sql"

üéâ –ö–æ–ø–∏—è –ë–î –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤: /path/to/server/dumps/dump_user_1_2024-01-15_14-30-45.sql
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ SQL-–¥–∞–º–ø–∞

–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã –∏–∑ SQL-–¥–∞–º–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `psql`:

```bash
psql -U postgres -h localhost -p 5432 -d calculations -f "dumps/dump_user_1_2024-01-15_14-30-45.sql"
```

–ì–¥–µ:
- `-U postgres` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `-h localhost` - —Ö–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `-p 5432` - –ø–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `-d calculations` - –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `-f` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É SQL-–¥–∞–º–ø–∞

**‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ö–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∞–º–ø–æ–º
- –ï—Å–ª–∏ —Å—Ö–µ–º–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ö–µ–º—É: `DROP SCHEMA IF EXISTS user_1 CASCADE;`
- –ó–∞—Ç–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –¥–∞–º–ø–∞

### –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É backup-calculations.js –∏ copy-database.js

| –ö—Ä–∏—Ç–µ—Ä–∏–π | backup-calculations.js | copy-database.js |
|----------|------------------------|------------------|
| –§–æ—Ä–º–∞—Ç | JSON | SQL |
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü | ‚ùå –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ | ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ + –¥–∞–Ω–Ω—ã–µ |
| –ò–Ω–¥–µ–∫—Å—ã –∏ constraints | ‚ùå | ‚úÖ |
| –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | –ú–µ–Ω—å—à–µ (—Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ) | –ë–æ–ª—å—à–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + –¥–∞–Ω–Ω—ã–µ) |
| –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ | –°–∫—Ä–∏–ø—Ç restore-calculations.js | –ö–æ–º–∞–Ω–¥–∞ psql |
| –£–¥–æ–±—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è | ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ (—á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç) | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç psql |
| –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç | ‚ùå | ‚úÖ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç PostgreSQL) |

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backup-calculations.js:**
- –î–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
- –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–∞–º–ø –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –î–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –±–∞–∑–∞–º–∏

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å copy-database.js:**
- –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ —Å—Ö–µ–º—ã –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –î–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ–π —Å—Ö–µ–º—ã –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
- –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π SQL-–¥–∞–º–ø PostgreSQL
- –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –ë–î

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±—ç–∫–∞–ø–æ–≤

### JSON-–±—ç–∫–∞–ø—ã (backup-calculations.js)

1. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –±—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –∏–ª–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ)

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤**: 
   - JSON-–±—ç–∫–∞–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `server/backups/`
   - SQL-–¥–∞–º–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `server/dumps/`
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±—ç–∫–∞–ø—ã –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ –Ω–æ—Å–∏—Ç–µ–ª–∏ –∏–ª–∏ –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
   - –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–æ–≤**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–æ–≤ –±—ç–∫–∞–ø–∞

4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ JSON-–±—ç–∫–∞–ø–∞**: 
   - –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ `--clear` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `restore-calculations.js` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

5. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –§–∞–π–ª—ã –±—ç–∫–∞–ø–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–µ—Ä—Å–∏–∏

### SQL-–¥–∞–º–º—ã (copy-database.js)

1. **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQL-–¥–∞–º–º—ã**:
   - –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ —Å—Ö–µ–º—ã –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü
   - –î–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä PostgreSQL
   - –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –ë–î
   - –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç PostgreSQL

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ SQL-–¥–∞–º–º–æ–≤**: 
   - SQL-–¥–∞–º–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `server/dumps/`
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏—Ö –Ω–æ—Å–∏—Ç–µ–ª—è—Ö
   - SQL-–¥–∞–º–º—ã –æ–±—ã—á–Ω–æ –±–æ–ª—å—à–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É —á–µ–º JSON-–±—ç–∫–∞–ø—ã

3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ SQL-–¥–∞–º–º–∞**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `psql` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:
     ```bash
     psql -U postgres -h localhost -p 5432 -d calculations -f "dumps/dump_user_1_2024-01-15_14-30-45.sql"
     ```
   - –ü–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ö–µ–º–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∞–º–ø–æ–º
   - –ï—Å–ª–∏ —Å—Ö–µ–º–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç—å –µ—ë: `DROP SCHEMA IF EXISTS user_1 CASCADE;`
   - –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ

4. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JSON-–±—ç–∫–∞–ø—ã –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQL-–¥–∞–º–º—ã –¥–ª—è –ø–æ–ª–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤ —Å—Ö–µ–º—ã –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

---

## create-media-files-table.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã `calculation_media_files` –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ö–µ–º–µ (–ø—É–±–ª–∏—á–Ω–æ–π –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π).

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ (PDF, JPG, PNG), –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö –∫ —Ä–∞—Å—á–µ—Ç–∞–º. –¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ö–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `dbManager`, –Ω–æ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è:
- –°–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ö–µ–º–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º–µ
- –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### 1. –ß–µ—Ä–µ–∑ npm script (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm run create-media-files-table
```

–°–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É –≤ —Å—Ö–µ–º–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `USER_ID`, –∏–ª–∏ –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º–µ, –µ—Å–ª–∏ `USER_ID` –Ω–µ —É–∫–∞–∑–∞–Ω.

#### 2. –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ node

```bash
node scripts/create-media-files-table.js
```

#### 3. –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ–∑–¥–∞—Å—Ç –≤ —Å—Ö–µ–º–µ user_X)

```bash
node scripts/create-media-files-table.js 1
```

–ì–¥–µ `1` - —ç—Ç–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É –≤ —Å—Ö–µ–º–µ `user_1`.

#### 4. –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º—ã

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ USER_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env, –∏–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
node scripts/create-media-files-table.js
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `USER_ID` –∏–∑ `.env` —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω –∞—Ä–≥—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è userId (–Ω–∏ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö, –Ω–∏ –≤ `.env`) —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º–µ (`public`)
- –° —É–∫–∞–∑–∞–Ω–∏–µ–º userId (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`) —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É –≤ —Å—Ö–µ–º–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`user_1`)
- –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü—ã
- –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `calculation` (–Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `CREATE TABLE IF NOT EXISTS`, –ø–æ—ç—Ç–æ–º—É —Å–∫—Ä–∏–ø—Ç –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ö–µ–º–µ (–±–µ–∑ .env –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤)

```bash
npm run create-media-files-table
```

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1 (—á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç)

```bash
node scripts/create-media-files-table.js 1
```

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º USER_ID –∏–∑ .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
USER_ID=1
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
npm run create-media-files-table
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã calculation_media_files...
–¶–µ–ª–µ–≤–∞—è —Å—Ö–µ–º–∞: user_1

‚úÖ –¢–∞–±–ª–∏—Ü–∞ calculation_media_files —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ –≤ —Å—Ö–µ–º–µ user_1

üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:
   1. id (integer) NOT NULL
   2. calculation_id (integer) NOT NULL
   3. file_name (character varying) NOT NULL
   4. file_type (character varying) NOT NULL
   5. file_size (integer) NOT NULL
   6. file_data (bytea) NOT NULL
   7. date_of_creation (timestamp with time zone)

üéâ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö:

- **–°—Ö–µ–º–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**: –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ —Å—Ö–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ –æ–Ω–∞ –Ω–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞
- **–¢–∞–±–ª–∏—Ü–∞ calculation –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**: –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞
- **–¢–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `dbManager.createUserDatabase()`
- –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
- –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –∫–∞—Å–∫–∞–¥–Ω—ã–º —É–¥–∞–ª–µ–Ω–∏–µ–º: –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã